
total load data: 28219
size : 45150
train size: 45150 test size: 11288 , 
############################ 176 :train_dataset: 45150
get data tarin loader ################################# torch.Size([256, 3, 256, 256])
pvt Summary: 319 layers, 24849856 parameters, 24.849856 M, 24849856 gradients
D:\anaconda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:209: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  f"The parameter '{pretrained_param}' is deprecated since 0.13 and may be removed in the future, "
D:\anaconda\envs\pytorch\lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
ResNet Summary: 116 layers, 21797672 parameters, 21.797672 M, 21797672 gradients
inc [ 128  256  576 1024]
inc [ 128  256  576 1024]
build DUAL model
using  cuda:0
Epoch 0/100
----------
X_train :torch.Size([256, 3, 256, 256])
Y: [torch.Size([256, 23]), torch.Size([256, 5]), torch.Size([256, 3]), torch.Size([256, 2]), torch.Size([256, 18]), torch.Size([256, 4]), torch.Size([256, 3]), torch.Size([256, 3]), torch.Size([256, 2]), torch.Size([256, 17]), torch.Size([256, 5]), torch.Size([256, 2]), torch.Size([256, 15]), torch.Size([256, 14])]
C:\Users\csz\Desktop\cs\AIE\model\model.py:74: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  q = self.softmax(torch.sum((self.down(self.down(c1 + c2) + c3) + c4), dim=1, keepdim=True))
X_train :torch.Size([256, 3, 256, 256])
Y: [torch.Size([256, 23]), torch.Size([256, 5]), torch.Size([256, 3]), torch.Size([256, 2]), torch.Size([256, 18]), torch.Size([256, 4]), torch.Size([256, 3]), torch.Size([256, 3]), torch.Size([256, 2]), torch.Size([256, 17]), torch.Size([256, 5]), torch.Size([256, 2]), torch.Size([256, 15]), torch.Size([256, 14])]
X_train :torch.Size([256, 3, 256, 256])
Y: [torch.Size([256, 23]), torch.Size([256, 5]), torch.Size([256, 3]), torch.Size([256, 2]), torch.Size([256, 18]), torch.Size([256, 4]), torch.Size([256, 3]), torch.Size([256, 3]), torch.Size([256, 2]), torch.Size([256, 17]), torch.Size([256, 5]), torch.Size([256, 2]), torch.Size([256, 15]), torch.Size([256, 14])]
Total ACC:0.8276, Impression ACC:0.5413, HyperF_Type ACC:0.6414, HyperF_Area(DA) ACC:0.8442, HyperF_Fovea ACC:1.0000, HyperF_ExtraFovea ACC:0.5187, HyperF_Y ACC:0.8727, HypoF_Type ACC:0.9473, HypoF_Area(DA) ACC:0.9062, HypoF_Fovea ACC:1.0000, HypoF_ExtraFovea ACC:0.7692, HypoF_Y ACC:0.9159, CNV ACC:1.0000, Vascular abnormality (DR) ACC:0.9084, Pattern ACC:0.7212, 
Train Loss is:14.7924
Test Loss is:2.4869
cost time:9.8500 min, ETA:975.1500
Epoch 1/100
----------
Train Loss is:13.6696
Test Loss is:2.7862
cost time:9.8167 min, ETA:962.0333
Epoch 2/100
----------
Train Loss is:13.0269
Test Loss is:2.5852
cost time:9.8333 min, ETA:953.8333
Epoch 3/100
----------
Train Loss is:12.5411
Test Loss is:2.5808
cost time:9.8167 min, ETA:942.4000
Epoch 4/100
----------
Train Loss is:12.1820
Test Loss is:2.8948
cost time:9.8333 min, ETA:934.1667
Epoch 5/100
----------
Train Loss is:11.8890
Test Loss is:2.6774
cost time:9.8500 min, ETA:925.9000
Epoch 6/100
----------
Train Loss is:11.6320
Test Loss is:2.7429
cost time:9.8167 min, ETA:912.9500
Counter 1 of 10
Epoch 7/100
----------
Train Loss is:11.4282
Test Loss is:2.8311
cost time:9.8167 min, ETA:903.1333
Counter 2 of 10
Epoch 8/100
----------
Train Loss is:11.2462
Test Loss is:2.8696
cost time:9.8167 min, ETA:893.3167
Counter 3 of 10
Epoch 9/100
----------
Train Loss is:11.0872
Test Loss is:3.0360
cost time:9.8333 min, ETA:885.0000
Counter 4 of 10
Epoch 10/100
----------
Total ACC:0.9056, Impression ACC:0.7867, HyperF_Type ACC:0.8042, HyperF_Area(DA) ACC:0.9102, HyperF_Fovea ACC:1.0000, HyperF_ExtraFovea ACC:0.6938, HyperF_Y ACC:0.9203, HypoF_Type ACC:0.9621, HypoF_Area(DA) ACC:0.9442, HypoF_Fovea ACC:1.0000, HypoF_ExtraFovea ACC:0.8553, HypoF_Y ACC:0.9512, CNV ACC:1.0000, Vascular abnormality (DR) ACC:0.9498, Pattern ACC:0.9005, 
Train Loss is:10.9523
Test Loss is:2.8698
cost time:9.8333 min, ETA:875.1667
Counter 5 of 10
Epoch 11/100
----------
Train Loss is:10.8169
Test Loss is:2.6302
cost time:9.8333 min, ETA:865.3333
Epoch 12/100
----------
Train Loss is:10.7041
Test Loss is:2.7900
cost time:9.8500 min, ETA:856.9500
Counter 1 of 10
Epoch 13/100
----------
Train Loss is:10.5935
Test Loss is:2.7645
cost time:9.8667 min, ETA:848.5333
Counter 2 of 10
Epoch 14/100
----------
Train Loss is:10.4904
Test Loss is:2.8556
cost time:9.8000 min, ETA:833.0000
Counter 3 of 10
Epoch 15/100
----------
Train Loss is:10.3994
Test Loss is:2.8943
cost time:9.8167 min, ETA:824.6000
Counter 4 of 10
Epoch 16/100
----------
Train Loss is:15.5859
Test Loss is:2.5394
cost time:9.8167 min, ETA:814.7833
Epoch 17/100
----------
Train Loss is:12.5209
Test Loss is:2.8902
cost time:9.8167 min, ETA:804.9667
Counter 1 of 10
Epoch 18/100
----------
Train Loss is:10.9874
Test Loss is:2.8192
cost time:9.9000 min, ETA:801.9000
Counter 2 of 10
Epoch 19/100
----------
Train Loss is:10.5333
Test Loss is:2.9059
cost time:9.8667 min, ETA:789.3333
Counter 3 of 10
Epoch 20/100
----------
Total ACC:0.9194, Impression ACC:0.8204, HyperF_Type ACC:0.8283, HyperF_Area(DA) ACC:0.9224, HyperF_Fovea ACC:1.0000, HyperF_ExtraFovea ACC:0.7461, HyperF_Y ACC:0.9240, HypoF_Type ACC:0.9632, HypoF_Area(DA) ACC:0.9569, HypoF_Fovea ACC:1.0000, HypoF_ExtraFovea ACC:0.8826, HypoF_Y ACC:0.9564, CNV ACC:1.0000, Vascular abnormality (DR) ACC:0.9549, Pattern ACC:0.9165, 
Train Loss is:10.3374
Test Loss is:2.8294
cost time:9.8167 min, ETA:775.5167
Counter 4 of 10
Epoch 21/100
----------
Train Loss is:10.2366
Test Loss is:2.9227
cost time:9.8333 min, ETA:767.0000
Counter 5 of 10
Epoch 22/100
----------
Train Loss is:10.1450
Test Loss is:2.9234
cost time:9.8333 min, ETA:757.1667
Counter 6 of 10
Epoch 23/100
----------
Train Loss is:10.0837
Test Loss is:2.7600
cost time:9.8333 min, ETA:747.3333
Counter 7 of 10
Epoch 24/100
----------
Train Loss is:10.0338
Test Loss is:2.8982
cost time:9.8167 min, ETA:736.2500
Counter 8 of 10
Epoch 25/100
----------
Train Loss is:9.9668
Test Loss is:2.7682
cost time:9.8167 min, ETA:726.4333
Counter 9 of 10
Epoch 26/100
----------
Train Loss is:9.9158
Test Loss is:2.8970
cost time:9.8167 min, ETA:716.6167
Counter 10 of 10
Epoch 27/100
----------
Train Loss is:9.8743
Test Loss is:2.9483
cost time:9.8000 min, ETA:705.6000
Counter 11 of 10
Early stopping with best_loss:  2.539386012819078 and val_acc for this epoch:  2.9482687367333305 ...
